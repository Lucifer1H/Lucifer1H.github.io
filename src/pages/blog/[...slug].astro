---
import { type CollectionEntry, getCollection } from 'astro:content';
import Layout from '../../layouts/Layout.astro';
import Comments from '../../components/Comments.astro';

export async function getStaticPaths() {
	const posts = await getCollection('blog');
	return posts.map((post) => ({
		params: { slug: post.slug },
		props: post,
	}));
}

type Props = CollectionEntry<'blog'>;

const post = Astro.props;
const { Content } = await post.render();
---

<Layout title={post.data.title} description={post.data.description}>
	<article class="max-w-none">
    <header class="mb-10 text-center">
      <div class="text-sm font-medium text-gray-500 dark:text-gray-400 mb-2 font-mono">
        <time datetime={post.data.pubDate.toISOString()}>
          {post.data.pubDate.toLocaleDateString('en-us', {
            year: 'numeric',
            month: 'long',
            day: 'numeric',
          })}
        </time>
      </div>
      <h1 class="text-3xl sm:text-4xl font-extrabold text-gray-900 dark:text-gray-100 tracking-tight leading-tight mb-4">
        {post.data.title}
      </h1>
      <div class="flex flex-wrap justify-center gap-2">
        {post.data.tags.map((tag) => (
          <span class="inline-flex items-center px-3 py-0.5 rounded-full text-xs font-medium bg-blue-100 dark:bg-blue-900/50 text-blue-800 dark:text-blue-200">
            {tag}
          </span>
        ))}
      </div>
      {post.data.heroImage && (
			<div class="mt-8 rounded-2xl overflow-hidden shadow-lg">
				<img src={post.data.heroImage} alt="" class="w-full object-cover" />
			</div>
      )}
    </header>

			<Content />
		</div>
    
    <div class="mt-16 pt-8 border-t border-gray-200 dark:border-gray-800">
      <Comments />
    </div>
	</article>
</Layout>
